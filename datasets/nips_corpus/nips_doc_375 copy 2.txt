A Neural Expert System with Automated Extraction 
of Fuzzy If-Then Rules and Its Application to 
Medical Diagnosis 
Yoichi Hayashi* 
Department of Computer and Information Sciences 
Ibaraki University 
Hitachi-shi, Ibaraki 316, Japan 
ABSTRACT 
This paper proposes a fuzzy neural expert system (FNES) with the 
following two functions: (1) Generalization of the information derived 
from the training data and embodiment of knowledge in the form of the 
fuzzy neural network; (2) Extraction of fuzzy '�-?hen rules with 
linguistic relative importance of each proposition in an antecedent 
('�-part) from a trained neural network. This paper also gives a 
method to extract automatically fuzzy If-Then rules from the trained 
neural network. To prove the effectiveness and validity of the proposed 
fuzzy neural expert system, a fuzzy neural expert system for medical 
diagnosis has been developed. 
1 INTRODUCTION 
Expert systems that have neural networks for their knowledge bases are sometimes called 
neural expert system (Gallant & Hayashi, 1990; Hayashi et al., 1990; Yoshida et al., 
1990) or connectionist expert system (Gallant, 1988; Yoshida et al., 1989). This paper 
extends work reported in (Hayashi & Nakai, 1990; Hayashi et al., 1990) and shows a new 
method to give confidence measurements for all inferences and explanations to neural 
expert systems. In contrast with conventional expert systems, we propose a fuzzy neural 
expert system (FNES) with automated extraction of fuzzy If-Then rules. This paper also 
gives a method to extract automatically fuzzy If-Then rules with linguistic relative 
importance of each proposition in an antecedent (If-part) from a trained neural network. 
To prove the effectiveness and validity of the proposed neural expert system, a fuzzy 
neural expert system for diagnosing hepatobiliary disorders has been developed by using a 
real medical database. This paper compares the diagnostic capability provided by the 
neural network approach and that provided by the statistical approach. Furthermore, we 
evaluate the performance of extracted fuzzy If-Then rules from a neural network 
knowledge base. 
*A part of this work was performed when the author was with the University of Alabama at 
Birmingham, Department of Computer and Information Sciences as a Visiting Associate 
Professor. 
578 
A Neural Expert System with Automated Extraction of Fuzzy If-Then Rules 579 
2 FUZZY NEURAL EXPERT SYSTEM WITH AUTOMATED 
EXTRACTION OF FUZZY IF-THEN RULES 
2.1 Distributed Neural Network 
Figure 1 illustrates a schematic diagram of a fuzzy neural expert system with automated 
extraction of fuzzy If-Then rules. For backpropagation, the configuration consisting ofp 
input cells, q intermediate cells (hidden units) and r output cells has been the most 
widely used. Connections run from every input cell to every intermediate cell, and from 
every intermediate cell to every output cell. In this paper, we employ a valiant of 
conventional perceptron network, which is called distributed (neural) network (Gallant, 
1990). In the network, there are the same cells and connections as with the 
backpropagation, and in addition there are direct connections from input to output cells. 
See Figure 2. Each connection has an integer weight wij that roughly corresponds to the 
influence of cell uj on cell ui. Although the weights of connections from the input layer 
to the intermediate layer are generated by using a random number generator (in this 
paper, integers between -10 and +10 were used) and fixed for learning process. Cell 
activations are discrete, each taking on values +1, 0, or -1. 
<Automated extraction of fuzzy IF-THEN rules> 
ll ll llll lll lll Ill 
1 Input of I I- . lion � I  1 
/nn'',l I=.g','.%. Knowiedg / . I I. 
K ,n,ss g ;; .... II 
/o ,,ao/User / t  I base I 
n d / / I .... I 
users/ /c' / I I 
/ I IT?' no, , I linear ltl 
/ / ', '  Matrixcontrolled  ,.,-.li 
 ml ,I ' - I 
bnfirmallon of I <Embodlement, generallzatlonand synthesis 
Inpul dB I  Iormatlonby learnl. 
l I 1 I lllllllllllllllllllllllllllll 
A proposed fuzzy neural neork 
Flgua 1: A Schematic Diagram of A Fuzzy Neural System wl 
Automated tractlon of Fuuy IF-THEN Rules 
Activations of the input cells li (i = 1,2,..., p), the intermediate cell Hj (j = 1,2,..., q) and 
the output cell Ok (k = 1,2,..., r) can be calculated using equations (1) - (4). The value of 
the cell I0 is always + 1, and it is connected to every other cell except for input cells. 
p P q 
SHj: Zwjil i (1) SOk= ZUkili+ Z vkjHj (3) 
i=0 i=o j=l 
Hj= or Unknown (SHj = 0 (2) O k= or Unknown (SO k = 0)(4) 
- or False (SHj < O) - or False (SO k < O) 
580 Ha�hi 
O u Output aye 
W  Lae 
Bias Cell Input Lyer 
:__ Trainable Connections 
 Randomly Generated Connections 
Figure 2: A Distributed Neural Network 
2.2 Fuzzy Neural Network 
To handle various fuzziness in the input layer of the distributed neural network, it is 
necessary to interpret subjective input data which has non-Boolean quantitative and/or 
qualitative meaning. In general, fuzzy sets def'med by monotone membership functions 
can be defuzzified into a family of crisp sets by using the level set representation 
(Negoita, 1985) or thermometer code of B. Widrow. Therefore, the fuzziness can be 
incorporated into the training data by using only Boolean inputs. Once the training data 
is set up in this manner, it can be processed by the Pocket Algorithm (Gallant, 1990). In 
this paper, we will propose a fuzzy neural network to handle fuzzy data and crisp data 
G; 
Fy Cell Group 
Gf G 
Crisp Cell Group 
Input Layer 
Figure 3: A Neural Network with Fuzzy Cell Groups and Crisp Cell Groups 
given in the input layer. Figure 3 shows the structure of proposed fuzzy neural network 
whose input layer consists of fuzzy cell groups and crisp (non-fuzzy) cell groups. Here, 
A Neural Expert System with Automated Extraction of Fuzzy If-Then Rules 581 
truthfulness of fuzzy information and crisp information such as binary encoded data is 
represented by fuzzy cell groups and crisp cell groups, respectively. A fuzzy cell group 
consists of m input cells which have the level set representation using binary m- 
dimensional vector, each taking on values in [+1, -1}; whereas a crisp cell group also 
consists of m input cells which take on two values in {(+1,+1,...,+1), (-1,-1,...,-1)}. 
3 AUTOMATED EXTRACTION OF FUZZY IF-THEN RULES FROM 
TRAINED NEURAL NETWORKS 
This paper also extends previous work described in (Hayashi & Nakai, 1990) and 
proposes a method to extract automatically fuzzy If-Then rules with linguistic relative 
importance of each proposition in an antecedent (Hayashi & Nakai, 1989) from a trained 
fuzzy neural network. The method is implemented in the knowledge analysis engine in 
Figure 1. The linguistic relative importance such as Very Important and Moderately 
Important, which is defined by a fuzzy set, represents the degree of effect of each 
proposition on consequence. By providing linguistic relative importance for each 
proposition, each fuzzy If-Then rule has more flexible expression than that of ordinary If- 
Then rules. Furthermore, truthfulness of each fuzzy If-Then rule is given in the form of 
linguistic truth value such as Very True and Possibly True, which is defined by a fuzzy 
set. Enhancement of the presentation capability and flexibility by using fuzzy If-Then 
rules with linguistic relative importance facilitates the automated exaction of fuzzy If- 
Then rules from a trained neural network. 
3.1 Automated If-Then Rule Extraction Algorithm 
We have proposed some methods to extract fuzzy If-Then rules with linguistic relative 
importance from a trained (fuzzy) neural network. In this section, we extend work 
reported in (Hayashi & Nakai, 1990; Hayashi et al., 1990) and give an algorithm to 
extract fuzzy If-Then rules from a trained fuzzy neural network in the following. Note 
that an exact algorithm of Step 2 and Step 3 can be derived from algorithms shown in 
(Hayashi & Nakai, 1990) in the same manner. Here, we will give a brief discussion on 
them due to space limitation. We shall concentrate on Stepl. 
Step 1. Extraction of framework of fuzzy If-then rules: We select 
propositions in an antecedent (' f-part) of a rule, that is, extract framework of fuzzy If- 
Then rules. We will give a precise algorithm for this step in section 3.2. 
Step 2. Assignment of linguistic truth value to each extracted rule: A 
linguistic truth value such as Very Very True (V.V.T.) and Possibly True (P.T.) is given 
to each fuzzy If-Then rule selected in Step 1. Linguistic truth value assigned to each rule 
indicates the degree of certainty to draw the conclusion. The linguistic truth value is 
determined by the relative amount of weighted sum of output cells. 
Step 3. Assignment of linguistic relative importance to each 
proposition: Linguistic relative importance is assigned to each proposition of 
antecedent in fuzzy If-Then rules. Linguistic relative importance such as Very Important 
(V.I.) and Moderately Important (M.I.) represents the degree of effect of each proposition 
on consequence. 
3.2 Algorithm to extract framework of fuzzy If-Then rules 
Extraction of dispensable propositions on cell groups in an antecedent (I f-part) is 
required for the extraction of framework of fuzzy If-Then rules. For simplicity, it is 
582 Hayashi 
supposed in this section that each cell consists of three input cells. Therefore, a fuzzy 
cell group takes on three values in [(+1,-1,-1), (+1,+1,-1), (+1,+1,+1)}; whereas a crisp 
cell group takes on two values in [(+1,+1,+1), (-1,-1,-1)}. In distributed neural network, 
we can determine activations (values) of cells using partial input information. For 
example, activations of intermediate cell Hj are determined as 
Hj = or Unknown ( I SHjl_ USHj ) (5) 
- or False (ISHjI>USHj and SHj<O) 
where 
= E Iwjl . (6) 
USH j j : l i is Unknn 
I
