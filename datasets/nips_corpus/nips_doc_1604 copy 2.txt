Predictive Sequence Learning in Recurrent 
Neocortical Circuits* 
R. P. N. Rao 
Computational Neurobiology Lab and 
Sloan Center for Theoretical Neurobiology 
The Salk Institute, La Jolla, CA 92037 
raosalk. edu 
T. J. Sejnowski 
Computational Neurobiology Lab and 
Howard Hughes Medical Institute 
The Salk Institute, La Jolla, CA 92037 
terrysalk. edu 
Abstract 
Neocortical circuits are dominated by massive excitatory feedback: more 
than eighty percent of the synapses made by excitatory cortical neurons 
are onto other excitatory cortical neurons. Why is there such massive re- 
current excitation in the neocortex and what is its role in cortical compu- 
tation? Recent neurophysiological experiments have shown that the plas- 
ticity of recurrent neocortical synapses is governed by a temporally asym- 
metric Hebbian learning rule. We describe how such a rule may allow 
the cortex to modify recurrent synapses for prediction of input sequences. 
The goal is to predict the next cortical input from the recent past based on 
previous experience of similar input sequences.. We show that a temporal 
difference learning rule for prediction used in conjunction with dendritic 
back-propagating action potentials reproduces the temporally asymmet- 
ric Hebbian plasticity observed physiologically. Biophysical simulations 
demonstrate that a network of cortical neurons can learn to predict mov- 
ing stimuli and develop direction selective responses as a consequence of 
learning. The space-time response properties of model neurons are shown 
to be similar to those of direction selective cells in alert monkey V1. 
1 INTRODUCTION 
The neocortex is characterized by an extensive system of recurrent excitatory connections 
between neurons in a given area. The precise computational function of this massive re- 
current excitation remains unknown. Previous modeling studies have suggested a role for 
excitatory feedback in amplifying feedforward inputs [ 1 ]. Recently, however, it has been 
shown that recurrent excitatory connections between cortical neurons are modified accord- 
ing to a temporally asymmetric Hebbian learning rule: synapses that are activated slightly 
before the cell fires are strengthened whereas those that are activated slightly after are weak- 
ened [2, 3]. Information regarding the postsynaptic activity of the cell is conveyed back to 
the dendritic locations of synapses by back-propagating action potentials from the soma. 
In this paper, we explore the hypothesis that recurrent excitation subserves the function of 
prediction and generation of temporal sequences in neocortical circuits [4, 5, 6]. We show 
'This research was supported by the Sloan Foundation and Howard Hughes Medical Institute. 
Predictive Sequence Learning in Recurrent Neocortical Circuits 165 
that a temporal difference based learning rule for prediction applied to backpropagating ac- 
tion potentials reproduces the experimentally observed phenomenon of asymmetric Heb- 
bian plasticity. We then show that such a learning mechanism can be used to learn temporal 
sequences and the property of direction selectivity emerges as a consequence of learning to 
predict moving stimuli. Space-time response plots of model neurons are shown to be similar 
to those of direction selective cells in alert macaque V1. 
2 
TEMPORALLY ASYMMETRIC HEBBIAN PLASTICITY AND 
TEMPORAL DIFFERENCE LEARNING 
To accurately predict input sequences, the recurrent excitatory connections in a network 
need to be adjusted such that the appropriate set of neurons are activated at each time step. 
This can be achieved by using a temporal-difference (TD) learning rule [5, 7]. In this 
paradigm of synaptic plasticity, an activated synapse is strengthened or weakened based on 
whether the difference between two temporally-separated predictions is positive or nega- 
tive. This minimizes the errors in prediction by ensuring that the prediction generated by 
the neuron after synaptic modification is closer to the desired value than before (see [7] for 
more details). 
In order to ascertain whether temporally-asymmetric Hebbian learning in cortical neurons 
can be interpreted as a form of temporal-difference learning, we used a two-compartment 
model of a cortical neuron consisting of a dendrite and a soma-axon compartment. The com- 
partmental model was based on a previous study that demonstrated the ability of such a 
model to reproduce a range of cortical response properties [8]. The presence of voltage- 
activated sodium channels in the dendrite allowed back-propagation of action potentials 
from the soma into the dendrite. To study plasticity, excitatory postsynaptic potentials (EP- 
SPs) were elicited at different time delays with respect to postsynaptic spiking by presynap- 
tic activation of a single excitatory synapse located on the dendrite. Synaptic currents were 
calculated using a kinetic model of synaptic transmission with model parameters fitted to 
whole-cell recorded AMPA currents (see [9] for more details). Synaptic plasticity was sim- 
ulated by incrementing or decrementing the value for maximal synaptic conductance by an 
amount proportional to the temporal-difference in the postsynaptic membrane potential at 
time instants t + At and t - At for presynaptic activation at time t. The delay parameter 
At was set to 5 ms to yield results consistent with previous physiological experiments [2]. 
Presynaptic input to the model neuron was paired with postsynaptic spiking by injecting 
a alepolarizing current pulse (10 ms, 200 pA) into the soma. Changes in synaptic efficacy 
were monitored by applying a test stimulus before and after pairing, and recording the EPSP 
evoked by the test stimulus. 
Figure 1A shows the results of pairings in which the postsynaptic spike was triggered 5 ms 
after and 5 ms before the onset of the EPSP respectively. While the peak EPSP amplitude 
was increased 58.5% in the former case, it was decreased 49.4% in the latter case, qualita- 
tively similar to experimental observations [2]. The critical window for synaptic modifica- 
tions in the model depends on the parameter At as well as the shape of the back-propagating 
action potential. This window of plasticity was examined by varying the time interval be- 
tween presynaptic stimulation and postsynaptic spiking (with At = 5 ms). As shown in 
Figure lB, changes in synaptic efficacy exhibited a highly asymmetric dependence on spike 
timing similar to physiological data [2]. Potentiation was observed for EPSPs that occurred 
between 1 and 12 ms before the postsynaptic spike, with maximal potentiation at 6 ms. Max- 
imal depression was observed for EPSPs occurring 6 ms after the peak of the postsynaptic 
spike and this depression gradually decreased, approaching zero for delays greater than 10 
ms. As in rat neocortical neurons, Xenopus tectal neurons, and cultured hippocampal neu- 
rons (see [2]), a narrow transition zone (roughly 3 ms in the model) separated the potentia- 
tion and depression windows. 
166 R. P. N. Rao and T. J. Sejnowski 
A 
before 
pairing 
'after 
15 ms 
15 ms 
150 
IO0 
-100 
-40 
-20 0 20 
Time of Synapfic Input (ms) 
40 
Figure 1: Synaptic Plasticity in a Model Neocortical Neuron. (A) (Left Panel) EPSP in the model 
neuron evoked by a presynaptic spike (S 1) at an excitatory synapse (before). Pairing this presynap- 
tic spike with postsynaptic spiking after a 5 ms delay (pairing) induces long-term potentiation (af- 
ter). (Right Panel) If presynaptic stimulation (S2) occurs 5 ms after postsynaptic firing, the synapse 
is weakened resulting in a corresponding decrease in peak EPSP amplitude. (B) Critical window for 
synaptic plasticity obtained by varying the delay between pre- and postsynaptic spiking (negative de- 
lays refer to presynaptic before postsynaptic spiking). 
3 RESULTS 
3.1 Learning Sequences using Temporally Asymmetric Hebbian Plasticity 
To see how a network of model neurons can learn sequences using the learning mechanism 
described above, consider the simplest case of two excitatory neurons N 1 and N2 connected 
to each other, receiving inputs from two separate input neurons I 1 and 12 (Figure 2A). Sup- 
pose input neuron I1 fires before input neuron 12, causing neuron N1 to fire (Figure 2B). 
The spike from N1 results in a sub-threshold EPSP in N2 due to the synapse S2. If input 
arrives from 12 any time between 1 and 12 ms after this EPSP and the temporal summation 
of these two EPSPs causes N2 to fire, the synapse S2 will be strengthened. The synapse S 1, 
on the other hand, will be weakened because the EPSP due to N2 arrives a few milliseconds 
after N1 has fired. Thus, on a subsequent trial, when input I1 causes neuron N1 to fire, N1 
in turn causes N2 to fire several milliseconds before input 12 occurs due to the potentiation 
of the recurrent synapse S2 in previous trial(s) (Figure 2C). Input neuron 12 can thus be in- 
hibited by the predictive feedback from N2 just before the occurrence of imminent input 
activity (marked by an asterisk in Figure 2C). This inhibition prevents input 12 from further 
exciting N2. Similarly, a positive feedback loop between neurons N1 and N2 is avoided 
because the synapse S 1 was weakened in previous trial(s) (see arrows in Figures 2B and 
2C). Figure 2D depicts the process of potentiation and depression of the two synapses as a 
function of the number of exposures to the 11-12 input sequence. The decrease in latency 
of the predictive spike elicited in N2 with respect to the timing of input 12 is shown in Fig- 
ure 2E. Notice that before learning, the spike occurs 3.2 ms after the occurrence of the input 
whereas after learning, it occurs 7.7 ms before the input. 
3.2 Emergence of Direction Selectivity 
In a second set of simulations, we used a network of recurrently connected excitatory neu- 
rons as shown in Figure 3A receiving retinotopic sensory input consisting of moving pulses 
of excitation (8 ms pulse
